slideshow_jquery_image_gallery_backend_script.slideshow=function(){var e=jQuery,i={};return i.isCurrentPage=!1,i.init=function(){"slideshow"===window.pagenow&&(i.isCurrentPage=!0)},e(document).bind("slideshowBackendReady",i.init),i}();
slideshow_jquery_image_gallery_backend_script.editSlideshow.slideManager=function(){var e=jQuery,t={};return t.uploader=null,t.init=function(){slideshow_jquery_image_gallery_backend_script.editSlideshow.isCurrentPage&&(t.activateUploader(),t.activate(),t.activeOldUploader())},t.activateUploader=function(){e(".slideshow-insert-image-slide").on("click",function(e){e.preventDefault();var i,l;return t.uploader?(t.uploader.open(),void 0):(l=window.slideshow_jquery_image_gallery_backend_script_editSlideshow,i="","object"==typeof l&&"object"==typeof l.localization&&void 0!==l.localization.uploaderTitle&&l.localization.uploaderTitle.length>0&&(i=l.localization.uploaderTitle),t.uploader=wp.media.frames.slideshow_jquery_image_galler_uploader=wp.media({frame:"select",title:i,multiple:!0,library:{type:"image"}}),t.uploader.on("select",function(){var e,i,l=t.uploader.state().get("selection").toJSON();for(i in l)l.hasOwnProperty(i)&&(e=l[i],t.insertImageSlide(e.id,e.title,e.description,e.url,e.alt))}),t.uploader.open(),void 0)})},t.activeOldUploader=function(){var i=e("#slideshow-slide-inserter-popup"),l=e("#slideshow-slide-inserter-popup-background"),s=i.find("#search");l.height(e(document).outerHeight(!0)),i.css({top:parseInt(e(window).height()/2-i.outerHeight(!0)/2,10),left:parseInt(e(window).width()/2-i.outerWidth(!0)/2,10)}),s.focus(),t.getSearchResults(),i.find("#close").click(t.closePopup),l.click(t.closePopup),i.find("#search-submit").click(t.getSearchResults),s.keypress(function(e){13==e.which&&(e.preventDefault(),t.getSearchResults())}),e("#slideshow-insert-image-slide").click(function(){i.css({display:"block"}),l.css({display:"block"})}),e("#slideshow-insert-text-slide").click(t.insertTextSlide),e("#slideshow-insert-video-slide").click(t.insertVideoSlide),e(".slideshow-delete-slide").click(function(i){t.deleteSlide(e(i.currentTarget).closest(".sortable-slides-list-item"))})},t.activate=function(){t.indexSlidesOrder(),e(".sortable-slides-list").sortable({revert:!0,placeholder:"sortable-placeholder",forcePlaceholderSize:!0,stop:function(){t.indexSlidesOrder()},cancel:"input, select, textarea"}),e(".wp-color-picker-field").wpColorPicker({width:234}),e(".open-slides-button").on("click",function(t){t.preventDefault(),e(".sortable-slides-list .sortable-slides-list-item").each(function(t,i){var l=e(i);l.find(".inside").is(":visible")||l.find(".handlediv").trigger("click")})}),e(".close-slides-button").on("click",function(t){t.preventDefault(),e(".sortable-slides-list .sortable-slides-list-item").each(function(t,i){var l=e(i);l.find(".inside").is(":visible")&&l.find(".handlediv").trigger("click")})})},t.deleteSlide=function(e){var t="Are you sure you want to delete this slide?",i=window.slideshow_jquery_image_gallery_backend_script_editSlideshow;"object"==typeof i&&"object"==typeof i.localization&&void 0!==i.localization.confirm&&i.localization.confirm.length>0&&(t=i.localization.confirm),confirm(t)&&e.remove()},t.indexSlidesOrder=function(){e(".sortable-slides-list .sortable-slides-list-item").each(function(t,i){e.each(e(i).find("input, select, textarea"),function(i,l){var s=e(l),n=s.attr("name");void 0===n||n.length<=0||(n=n.replace(/[\[\]']+/g," ").split(" "),s.attr("name",n[0]+"["+(t+1)+"]["+n[2]+"]"))})})},t.getSearchResults=function(i){var l=e("#slideshow-slide-inserter-popup"),s=l.find("#results"),n=[];i=parseInt(i,10),isNaN(i)&&(i=0,s.html("")),e.each(s.find(".result-table-row"),function(t,i){n.push(parseInt(e(i).attr("data-attachment-id"),10))}),e.post(window.ajaxurl,{action:"slideshow_slide_inserter_search_query",search:l.find("#search").attr("value"),offset:i,attachmentIDs:n},function(i){var l;s.append(i),s.find(".insert-attachment").unbind("click").click(function(i){var l=e(i.currentTarget).closest("tr");t.insertImageSlide(l.attr("data-attachment-id"),l.find(".title").text(),l.find(".description").text(),l.find(".image img").attr("src"),l.find(".title").text())}),l=e(".load-more-results"),l&&l.click(function(i){var l=e(i.currentTarget),s=l.attr("data-offset");l.closest("tr").hide(),isNaN(parseInt(s,10))||t.getSearchResults(s)})})},t.insertImageSlide=function(i,l,s,n,a){var d=e(".image-slide-template").find(".sortable-slides-list-item").clone(!0,!0);d.find(".attachment").attr("src",n),d.find(".attachment").attr("title",l),d.find(".attachment").attr("alt",a),d.find(".title").attr("value",l),d.find(".description").html(s),d.find(".alternativeText").attr("value",a),d.find(".postId").attr("value",i),d.find(".title").attr("name","slides[0][title]"),d.find(".titleElementTagID").attr("name","slides[0][titleElementTagID]"),d.find(".description").attr("name","slides[0][description]"),d.find(".descriptionElementTagID").attr("name","slides[0][descriptionElementTagID]"),d.find(".url").attr("name","slides[0][url]"),d.find(".urlTarget").attr("name","slides[0][urlTarget]"),d.find(".alternativeText").attr("name","slides[0][alternativeText]"),d.find(".noFollow").attr("name","slides[0][noFollow]"),d.find(".type").attr("name","slides[0][type]"),d.find(".postId").attr("name","slides[0][postId]"),e(".sortable-slides-list").prepend(d),t.indexSlidesOrder()},t.insertTextSlide=function(){var i=e(".text-slide-template").find(".sortable-slides-list-item").clone(!0,!0);i.find(".title").attr("name","slides[0][title]"),i.find(".titleElementTagID").attr("name","slides[0][titleElementTagID]"),i.find(".description").attr("name","slides[0][description]"),i.find(".descriptionElementTagID").attr("name","slides[0][descriptionElementTagID]"),i.find(".textColor").attr("name","slides[0][textColor]"),i.find(".color").attr("name","slides[0][color]"),i.find(".url").attr("name","slides[0][url]"),i.find(".urlTarget").attr("name","slides[0][urlTarget]"),i.find(".noFollow").attr("name","slides[0][noFollow]"),i.find(".type").attr("name","slides[0][type]"),i.find(".color, .textColor").wpColorPicker(),e(".sortable-slides-list").prepend(i),t.indexSlidesOrder()},t.insertVideoSlide=function(){var i=e(".video-slide-template").find(".sortable-slides-list-item").clone(!0,!0);i.find(".videoId").attr("name","slides[0][videoId]"),i.find(".showRelatedVideos").attr("name","slides[0][showRelatedVideos]"),i.find(".type").attr("name","slides[0][type]"),e(".sortable-slides-list").prepend(i),t.indexSlidesOrder()},t.closePopup=function(){e("#slideshow-slide-inserter-popup, #slideshow-slide-inserter-popup-background").css({display:"none"})},e(document).bind("slideshowBackendReady",t.init),t}();